---
title: "MA615 Assignment3"
author: "William Zen, Jack Carbaugh, Zara Waheed, Kosuke Sasaki"
date: "11/17/2021"
output: html_document
runtime: shiny
---

```{r setup, include=FALSE}
Sys.setenv("LANGUAGE" = "EN")
Sys.setlocale("LC_ALL", "C")
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(tidyverse)
library(magrittr)
library(shiny)
library(maps)
library(drat)
library(hurricaneexposuredata)
library(hurricaneexposure)
library(ggplot2)
```

```{r, include = FALSE}
source("hmap.R")
source("buoy import-a.R")
```

# History and details

- Hurricane Katrina was a tropical cyclone that struck the southeastern United States in late August 2005. 
- The hurricane and its aftermath claimed more than 1,800 lives
- Ranked as the costliest natural disaster in U.S. history
- Originated as a tropical depression from the merger of a tropical wave and the remnants of Tropical Depression Ten.

# Rainfall from hurricane data

The graphs below in shiny show the changes of rainfall as Katrina approached. As you can see with selecting the rainfall day, there was not any rainfall 2 days before the landfall, and the rain began to fall gradually along the Katrina's track 1 day before the landfall, and reached its maximum on the day. The next day, however, the rain disappeared again.

The application below can help you navigate between different days before and after the hurricane occured. The maps show the rainfall levels detected by different buoys.

```{r, echo=FALSE}
# rainfall
ui_1 <- fluidPage(
  selectInput("days", "select the rainfall day (landfall is day 0)", c(-5:5)),
  plotOutput("plot"),
)
server_1 <- function(input, output, session) {
  output$plot <- renderPlot({maprain(input$days)}, res = 96)
  }

shinyApp(ui_1, server_1)

```

# Variogram results

We displayed the variance between the gust speeds from different buoys at the time of landing in a variogram. 

```{r, echo=FALSE, warning=FALSE}
plot(v$dist, v$gamma,  pch = 19, col = "gray",
     xlab = "distance", ylab = "semivariogram", main="Gust Speed Variogram")
lines(h, v_f(h))
abline(v = v_fit$range[2], col = "gray")
```


However, the variogram did not converge and the results were not very meaningful. Some reasons for this could be:

- We used too small a number of buoys to get the sense of a significant relationship between them.
- The buoy data is measured inconsistently
- Missing data values are shown as extremely high values instead of no data values.
